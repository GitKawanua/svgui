{"version":3,"file":"page.js","sources":["../../src/js/page/utils.js","../../src/js/utils/storage.js","../../src/js/page/worker-messenger.js","../../src/js/page/gzip.js","../../src/js/page/svg-file.js","../../src/js/page/ui/pan-zoom.js","../../src/js/page/ui/svg-output.js","../../src/js/page/ui/code-output.js","../../src/js/page/prism.js","../../src/js/page/ui/output.js","../../src/js/page/ui/ripple.js","../../src/js/page/ui/spinner.js","../../src/js/page/ui/floating-action-button.js","../../src/js/page/ui/download-button.js","../../src/js/page/ui/copy-button.js","../../src/js/page/ui/bg-fill-button.js","../../src/js/page/ui/results.js","../../node_modules/nanoevents/index.js","../../src/js/page/ui/material-slider.js","../../src/js/page/ui/settings.js","../../src/js/page/ui/main-menu.js","../../src/js/page/ui/toasts.js","../../src/js/page/ui/file-drop.js","../../src/js/page/ui/preloader.js","../../src/js/page/ui/changelog.js","../../src/js/page/ui/results-container.js","../../src/js/page/ui/view-toggler.js","../../src/js/page/results-cache.js","../../src/js/page/ui/main-ui.js","../../src/js/page/main-controller.js","../../src/js/page/svgo.js","../../src/js/page/index.js"],"sourcesContent":["export const domReady = new Promise(resolve => {\n  function checkState() {\n    if (document.readyState != 'loading') resolve();\n  }\n  document.addEventListener('readystatechange', checkState);\n  checkState();\n});\n\nconst range = document.createRange();\nrange.selectNode(document.documentElement);\n\nexport function strToEl(str) {\n  const frag = range.createContextualFragment(str);\n  return frag.children[0];\n}\n\nconst entityMap = {\n  \"&\": \"&amp;\",\n  \"<\": \"&lt;\",\n  \">\": \"&gt;\",\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  \"/\": '&#x2F;'\n};\n\nexport function escapeHTML(str) {\n  return String(str).replace(/[&<>\"'/]/g, s => entityMap[s]);\n}\n\nexport function escapeHtmlTag(strings, ...values) {\n  values = values.map(s => escapeHTML(s));\n  return strings.reduce((str, val, i) => str += val + (values[i] || ''), '');\n}\n\nexport function readFileAsText(file) {\n  return new Response(file).text();\n}\n\nfunction transitionClassFunc({removeClass = false}={}) {\n  return function(el, className = 'active', transitionClass = 'transition') {\n    if (removeClass) {\n      if (!el.classList.contains(className)) return Promise.resolve();\n    }\n    else {\n      if (el.classList.contains(className)) return Promise.resolve();\n    }\n\n    const transitionEnd = new Promise(resolve => {\n      const listener = event => {\n        if (event.target != el) return;\n        el.removeEventListener('transitionend', listener);\n        el.classList.remove(transitionClass);\n        resolve();\n      };\n\n      el.classList.add(transitionClass);\n\n      requestAnimationFrame(() => {\n        el.addEventListener('transitionend', listener);\n        el.classList[removeClass ? 'remove' : 'add'](className);\n      });\n    });\n\n    const transitionTimeout = new Promise(resolve => setTimeout(resolve, 1000));\n\n    return Promise.race([transitionEnd, transitionTimeout]);\n  };\n}\n\nexport const transitionToClass = transitionClassFunc();\nexport const transitionFromClass = transitionClassFunc({removeClass: true});\n\nexport function trackFocusMethod() {\n  var focusMethod = 'mouse';\n\n  document.body.addEventListener('focus', event => {\n    event.target.classList.add(focusMethod == 'key' ? 'key-focused' : 'mouse-focused');\n  }, true);\n\n  document.body.addEventListener('blur', event => {\n    event.target.classList.remove('key-focused', 'mouse-focused');\n  }, true);\n\n  document.body.addEventListener('keydown', () => {\n    focusMethod = 'key';\n  }, true);\n\n  document.body.addEventListener('mousedown', () => {\n    focusMethod = 'mouse';\n  }, true);\n}\n","export let idbKeyval = (() => {\n  let db;\n\n  function getDB() {\n    if (!db) {\n      db = new Promise((resolve, reject) => {\n        const openreq = indexedDB.open('svgo-keyval', 1);\n\n        openreq.onerror = () => {\n          reject(openreq.error);\n        };\n\n        openreq.onupgradeneeded = () => {\n          // First time setup: create an empty object store\n          openreq.result.createObjectStore('keyval');\n        };\n\n        openreq.onsuccess = () => {\n          resolve(openreq.result);\n        };\n      });\n    }\n    return db;\n  }\n\n  async function withStore(type, callback) {\n    const db = await getDB();\n    return new Promise((resolve, reject) => {\n      const transaction = db.transaction('keyval', type);\n      transaction.oncomplete = () => resolve();\n      transaction.onerror = () => reject(transaction.error);\n      callback(transaction.objectStore('keyval'));\n    });\n  }\n\n  return {\n    async get(key) {\n      let req;\n      await withStore('readonly', store => {\n        req = store.get(key);\n      });\n      return req.result;\n    },\n    set(key, value) {\n      return withStore('readwrite', store => {\n        store.put(value, key);\n      });\n    },\n    delete(key) {\n      return withStore('readwrite', store => {\n        store.delete(key);\n      });\n    }\n  };\n})();\n\n// iOS add-to-homescreen is missing IDB, or at least it used to.\n// I haven't tested this in a while.\nif (!self.indexedDB) {\n  idbKeyval = {\n    get: key => Promise.resolve(localStorage.getItem(key)),\n    set: (key, val) => Promise.resolve(localStorage.setItem(key, val)),\n    delete: key => Promise.resolve(localStorage.removeItem(key))\n  };\n}\n","export default class WorkerMessenger {\n  constructor(url) {\n    this._requestId = 0;\n    // worker jobs awaiting response { [requestId]: [ resolve, reject ] }\n    this._pending = {};\n    this._url = url;\n    this._worker = null;\n  }\n\n  release() {\n    this._abortPending();\n    if (this._worker) {\n      this._worker.terminate();\n      this._worker = null;\n    }\n  }\n\n  abort() {\n    if (Object.keys(this._pending).length === 0) return;\n\n    this._abortPending();\n    if (this._worker) {\n      this._worker.terminate();\n    }\n    this._startWorker();\n  }\n\n  _abortPending() {\n    for (const key of Object.keys(this._pending)) {\n      this._fulfillPending(key, null, new DOMException(\"AbortError\", \"AbortError\"));\n    }\n  }\n\n  _startWorker() {\n    this._worker = new Worker(this._url);\n    this._worker.onmessage = event => this._onMessage(event);\n  }\n\n  _postMessage(message) {\n    if (!this._worker) {\n      this._startWorker();\n    }\n    this._worker.postMessage(message);\n  }\n\n  _onMessage(event) {\n    if (!event.data.id) {\n      console.log(\"Unexpected message\", event);\n      return;\n    }\n\n    this._fulfillPending(\n      event.data.id,\n      event.data.result,\n      event.data.error && new Error(event.data.error),\n    );\n  }\n\n  _fulfillPending(id, result, error) {\n    const resolver = this._pending[id];\n\n    if (!resolver) {\n      console.log(\"No resolver for\", { id, result, error });\n      return;\n    }\n\n    delete this._pending[id];\n\n    if (error) {\n      resolver[1](error);\n      return;\n    }\n\n    resolver[0](result);\n  }\n\n  _requestResponse(message) {\n    return new Promise((resolve, reject) => {\n      message.id = ++this._requestId;\n      this._pending[message.id] = [resolve, reject];\n      this._postMessage(message);\n    });\n  }\n}\n","import WorkerMessenger from './worker-messenger';\n\nclass Gzip extends WorkerMessenger {\n  constructor() {\n    super('js/gzip-worker.js');\n  }\n\n  compress(svgData) {\n    return this._requestResponse({\n      data: svgData\n    });\n  }\n}\n\nexport const gzip = new Gzip();\n","import { gzip } from './gzip';\n\nexport default class SvgFile {\n  constructor(text, width, height) {\n    this.text = text;\n    this._compressedSize = null;\n    this._url = null;\n    this.width = width;\n    this.height = height;\n  }\n\n  async size({ compress }) {\n    if (!compress) {\n      return this.text.length;\n    }\n\n    if (!this._compressedSize) {\n      this._compressedSize = gzip.compress(this.text).then(r => r.byteLength);\n    }\n\n    return this._compressedSize;\n  }\n\n  get url() {\n    if (!this._url) {\n      this._url = URL.createObjectURL(\n        new Blob([this.text], { type: 'image/svg+xml' })\n      );\n    }\n\n    return this._url;\n  }\n\n  release() {\n    if (!this._url) return;\n\n    URL.revokeObjectURL(this._url);\n  }\n}\n","function getXY(obj) {\n  return {\n    x: obj.pageX,\n    y: obj.pageY\n  };\n}\n\nfunction touchDistance(touch1, touch2) {\n  const dx = Math.abs(touch2.x - touch1.x);\n  const dy = Math.abs(touch2.y - touch1.y);\n  return Math.sqrt(dx*dx + dy*dy);\n}\n\nfunction getMidpoint(point1, point2) {\n  return {\n    x: (point1.x + point2.x) / 2,\n    y: (point1.y + point2.y) / 2\n  };\n}\n\nfunction getPoints(event) {\n  if (event.touches) {\n    return Array.from(event.touches).map(t => getXY(t));\n  }\n  else {\n    return [getXY(event)];\n  }\n}\n\nexport default class PanZoom {\n  constructor(target, {\n    eventArea = target,\n    shouldCaptureFunc = () => true\n  }={}) {\n    this._target = target;\n    this._shouldCaptureFunc = shouldCaptureFunc;\n    this._dx = 0;\n    this._dy = 0;\n    this._scale = 1;\n    this._active = 0;\n    this._lastPoints = [];\n\n    // bind\n    [\n      '_onPointerDown',\n      '_onPointerMove',\n      '_onPointerUp'\n    ].forEach(funcName => {\n      this[funcName] = this[funcName].bind(this);\n    });\n\n    // bound events\n    eventArea.addEventListener('mousedown', this._onPointerDown);\n    eventArea.addEventListener('touchstart', this._onPointerDown);\n\n    // unbonud\n    eventArea.addEventListener('wheel', e => this._onWheel(e));\n  }\n\n  reset() {\n    this._dx = 0;\n    this._dy = 0;\n    this._scale = 1;\n    this._update();\n  }\n\n  _onWheel(event) {\n    if (!this._shouldCaptureFunc(event.target)) return;\n    event.preventDefault();\n\n    const boundingRect = this._target.getBoundingClientRect();\n    let delta = event.deltaY;\n\n    if (event.deltaMode === 1) { // 1 is \"lines\", 0 is \"pixels\"\n      // Firefox uses \"lines\" when mouse is connected\n      delta *= 15;\n    }\n\n    // stop mouse wheel producing huge values\n    delta = Math.max(Math.min(delta, 60), -60);\n\n    const scaleDiff = (delta / 300) + 1;\n\n    // avoid to-small values\n    if (this._scale * scaleDiff < 0.05) return;\n\n    this._scale *= scaleDiff;\n    this._dx -= (event.pageX - boundingRect.left) * (scaleDiff - 1);\n    this._dy -= (event.pageY - boundingRect.top) * (scaleDiff - 1);\n    this._update();\n  }\n\n  _onFirstPointerDown() {\n    document.addEventListener('mousemove', this._onPointerMove);\n    document.addEventListener('mouseup', this._onPointerUp);\n    document.addEventListener('touchmove', this._onPointerMove);\n    document.addEventListener('touchend', this._onPointerUp);\n  }\n\n  _onPointerDown(event) {\n    if (event.type == 'mousedown' && event.button !== 0) return;\n    if (!this._shouldCaptureFunc(event.target)) return;\n    event.preventDefault();\n\n    this._lastPoints = getPoints(event);\n    this._active++;\n\n    if (this._active === 1) {\n      this._onFirstPointerDown();\n    }\n  }\n\n  _onPointerMove(event) {\n    event.preventDefault();\n    const points = getPoints(event);\n    const averagePoint = points.reduce(getMidpoint);\n    const averageLastPoint = this._lastPoints.reduce(getMidpoint);\n    const boundingRect = this._target.getBoundingClientRect();\n\n    this._dx += averagePoint.x - averageLastPoint.x;\n    this._dy += averagePoint.y - averageLastPoint.y;\n\n    if (points[1]) {\n      const scaleDiff = touchDistance(points[0], points[1]) / touchDistance(this._lastPoints[0], this._lastPoints[1]);\n      this._scale *= scaleDiff;\n      this._dx -= (averagePoint.x - boundingRect.left) * (scaleDiff - 1);\n      this._dy -= (averagePoint.y - boundingRect.top) * (scaleDiff - 1);\n    }\n\n    this._update();\n    this._lastPoints = points;\n  }\n\n  _update() {\n    this._target.style.transform = `translate3d(${this._dx}px, ${this._dy}px, 0) scale(${this._scale})`;\n  }\n\n  _onPointerUp(event) {\n    event.preventDefault();\n    this._active--;\n    this._lastPoints.pop();\n\n    if (this._active) {\n      this._lastPoints = getPoints(event);\n      return;\n    }\n\n    document.removeEventListener('mousemove', this._onPointerMove);\n    document.removeEventListener('mouseup', this._onPointerUp);\n    document.removeEventListener('touchmove', this._onPointerMove);\n    document.removeEventListener('touchend', this._onPointerUp);\n  }\n}\n","import { domReady, strToEl } from '../utils';\nimport PanZoom from './pan-zoom';\n\nexport default class SvgOutput {\n  constructor() {\n    this.container = strToEl(\n      '<div class=\"svg-output\">' +\n        '<div class=\"svg-container\">' +\n          '<iframe class=\"svg-frame\" sandbox=\"allow-scripts\"></iframe>' +\n        '</div>' +\n        // Stop touches going into the iframe.\n        // pointer-events + touch + iframe doesn't work in Chrome :(\n        '<div class=\"svg-clickjacker\"></div>' +\n      '</div>' +\n    '');\n\n\n    this._svgFrame = this.container.querySelector('.svg-frame');\n    this._svgFrame.scrolling = 'no';\n\n    this._svgContainer = this.container.querySelector('.svg-container');\n\n    domReady.then(() => {\n      this._panZoom = new PanZoom(this._svgContainer, {\n        eventArea: this.container\n      });\n    });\n  }\n\n  setSvg(svgFile) {\n    // I would rather use blob urls, but they don't work in Firefox\n    // All the internal refs break.\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1125667\n    const nextLoad = this._nextLoadPromise();\n    this._svgFrame.src = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(svgFile.text);\n    this._svgFrame.width = svgFile.width;\n    this._svgFrame.height = svgFile.height;\n    return nextLoad;\n  }\n\n  reset() {\n    this._svgFrame.src = \"about:blank\";\n    this._panZoom.reset();\n  }\n\n  _nextLoadPromise() {\n    return new Promise(resolve => {\n      const onload = () => {\n        this._svgFrame.removeEventListener('load', onload);\n        resolve();\n      };\n      this._svgFrame.addEventListener('load', onload);\n    });\n  }\n}\n","import { strToEl } from '../utils';\nimport Prism from '../prism';\nconst prism = new Prism();\n\nexport default class CodeOutput {\n  constructor() {\n    this.container = strToEl(\n      '<div class=\"code-output\">' +\n        '<pre><code></code></pre>' +\n      '</div>' +\n    '');\n    this._codeEl = this.container.querySelector('code');\n  }\n\n  async setSvg(svgFile) {\n    this._codeEl.innerHTML = await prism.highlight(svgFile.text);\n  }\n\n  reset() {\n    this._codeEl.innerHTML = '';\n  }\n}\n","import WorkerMessenger from './worker-messenger';\n\nexport default class Prism extends WorkerMessenger {\n  constructor() {\n    super('js/prism-worker.js');\n  }\n\n  highlight(svgData) {\n    return this._requestResponse({\n      data: svgData\n    });\n  }\n}\n","import { strToEl, transitionToClass, transitionFromClass } from '../utils';\nimport SvgOutput from './svg-output';\nimport CodeOutput from './code-output';\n\nexport default class Output {\n  constructor() {\n    this.container = strToEl(\n      '<div class=\"output-switcher\"></div>' +\n    '');\n\n    this._types = {\n      image: new SvgOutput(),\n      code: new CodeOutput()\n    };\n\n    this._svgFile = null;\n    this._switchQueue = Promise.resolve();\n    this.set('image', {noAnimate: true});\n  }\n\n  update(svgFile) {\n    this._svgFile = svgFile;\n    return this._types[this._activeType].setSvg(svgFile);\n  }\n\n  reset() {\n    this._types[this._activeType].reset();\n  }\n\n  set(type, {\n    noAnimate = false\n  }={}) {\n    return this._switchQueue = this._switchQueue.then(async () => {\n      const toRemove = this._activeType && this._types[this._activeType].container;\n\n      this._activeType = type;\n      const toAdd = this._types[this._activeType].container;\n      this.container.appendChild(toAdd);\n\n      if (this._svgFile) await this.update(this._svgFile);\n\n      if (noAnimate) {\n        toAdd.classList.add('active');\n        if (toRemove) toRemove.classList.remove('active');\n      }\n      else {\n        const transitions = [\n          transitionToClass(toAdd)\n        ];\n\n        if (toRemove) transitions.push(transitionFromClass(toRemove));\n\n        await Promise.all(transitions);\n      }\n\n      if (toRemove) this.container.removeChild(toRemove);\n    });\n  }\n}\n","import { strToEl } from '../utils';\n\nexport default class Ripple {\n  constructor() {\n    this.container = strToEl('<div class=\"ripple\"></div>');\n  }\n\n  animate() {\n    this.container.classList.remove('animate');\n    this.container.offsetLeft;\n    this.container.classList.add('animate');\n  }\n}\n","import { strToEl } from '../utils';\n\nexport default class Spinner {\n  constructor() {\n    this.container = strToEl(\n      '<div class=\"spinner\">' +\n        '<div class=\"spinner-container\">' +\n          '<div class=\"spinner-layer\">' +\n            '<div class=\"circle-clipper left\">' +\n              '<div class=\"circle\"></div>' +\n            '</div>' +\n            '<div class=\"gap-patch\">' +\n              '<div class=\"circle\"></div>' +\n            '</div>' +\n            '<div class=\"circle-clipper right\">' +\n              '<div class=\"circle\"></div>' +\n            '</div>' +\n          '</div>' +\n        '</div>' +\n      '</div>' +\n    '');\n\n    this._showTimeout = null;\n    this.container.style.display = 'none';\n\n    const animEndListener = event => {\n      if (event.target == this.container) {\n        this.container.style.display = 'none';\n      }\n    };\n\n    this.container.addEventListener('animationend', animEndListener);\n  }\n\n  show(delay = 300) {\n    clearTimeout(this._showTimeout);\n    this.container.style.display = 'none';\n    this.container.classList.remove('cooldown');\n    this._showTimeout = setTimeout(() => {\n      this.container.style.display = '';\n    }, delay);\n  }\n\n  hide() {\n    clearTimeout(this._showTimeout);\n    this.container.classList.add('cooldown');\n  }\n}\n","import { strToEl } from '../utils';\nimport Ripple from './ripple';\nimport Spinner from './spinner';\n\nexport default class FloatingActionButton {\n  constructor({ title, href, iconSvg, classList, minor }) {\n    this.container = strToEl(\n      (href ? '<a>' : '<div role=\"button\" tabindex=\"0\">') +\n        iconSvg +\n      (href ? '</a>' : '</div>') +\n    '');\n\n    if (href) {\n      this.container.href = href;\n    }\n    if (title) {\n      this.container.setAttribute('title', title);\n    }\n    this.container.classList.add(minor ? 'minor-floating-action-button' : 'floating-action-button');\n    if (classList) {\n      classList.forEach((className) => { this.container.classList.add(className); });\n    }\n\n    this._ripple = new Ripple();\n    this.container.appendChild(this._ripple.container);\n\n    this._spinner = new Spinner();\n    this.container.appendChild(this._spinner.container);\n\n    this.container.addEventListener('click', () => this._onClick());\n  }\n\n  _onClick() {\n    this._ripple.animate();\n  }\n\n  working() {\n    this._spinner.show(500);\n  }\n\n  done() {\n    this._spinner.hide();\n  }\n}\n","import FloatingActionButton from './floating-action-button';\n\nexport default class DownloadButton extends FloatingActionButton {\n  constructor() {\n    const title = 'Download';\n\n    super({\n      title,\n      href: './',\n      iconSvg: (\n        '<svg class=\"icon\" viewBox=\"0 0 24 24\">' +\n          `<title>${title}</title>` +\n          '<path d=\"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z\"/>' +\n        '</svg>'\n      )\n    });\n  }\n\n  _onClick(event) {\n    super._onClick(event);\n  }\n\n  setDownload(filename, svgFile) {\n    this.container.download = filename;\n    this.container.href = svgFile.url;\n  }\n}\n","import FloatingActionButton from './floating-action-button';\n\nexport default class CopyButton extends FloatingActionButton {\n  constructor() {\n    const title = 'Copy as text';\n\n    super({\n      title,\n      iconSvg: (\n        '<svg class=\"icon\" viewBox=\"0 0 24 24\">' +\n          `<title>${title}</title>` +\n          '<path d=\"M16 1H4C3 1 2 2 2 3v14h2V3h12V1zm3 4H8C7 5 6 6 6 7v14c0 1 1 2 2 2h11c1 0 2-1 2-2V7c0-1-1-2-2-2zm0 16H8V7h11v14z\"/>' +\n        '</svg>'\n      ),\n      minor: true\n    });\n\n    this._text = null;\n    this._pre = document.createElement('pre');\n  }\n\n  _onClick(event) {\n    super._onClick(event);\n    this.copyText();\n  }\n\n  copyText() {\n    if (!this._text) return false;\n  \n    this._pre.textContent = this._text;\n    document.body.appendChild(this._pre);\n    getSelection().removeAllRanges();\n\n    const range = document.createRange();\n    range.selectNode(this._pre);\n\n    window.getSelection().addRange(range);\n\n    document.execCommand('copy');\n    getSelection().removeAllRanges();\n    document.body.removeChild(this._pre);\n    \n    return true;\n  }\n  setCopyText(text) {\n    this._text = text;\n  }\n  \n\n}\n","import FloatingActionButton from './floating-action-button';\n\nexport default class BgFillButton extends FloatingActionButton {\n  constructor() {\n    const title = 'Preview on vivid background';\n\n    super({\n      title,\n      iconSvg: (\n        '<svg class=\"icon\" viewBox=\"0 0 24 24\">' +\n          `<title>${title}</title>` +\n          '<path d=\"M21.143 9.667c-.733-1.392-1.914-3.05-3.617-4.753C14.549 1.936 12.048 1 10.741 1c-.414 0-.708.094-.86.246L8.52 2.606c-1.899-.236-3.42.106-4.294.983-.876.875-1.164 2.159-.792 3.523.492 1.806 2.305 4.049 5.905 5.375.038.323.157.638.405.885.588.588 1.535.586 2.121 0s.588-1.533.002-2.119a1.5 1.5 0 0 0-2.123-.001l-.17.256c-2.031-.765-3.395-1.828-4.232-2.9l3.879-3.875c.496 2.73 6.432 8.676 9.178 9.178l-7.115 7.107c-.234.153-2.798-.316-6.156-3.675-3.393-3.393-3.175-5.271-3.027-5.498L3.96 9.989C3.521 9.63 3.035 8.886 2.819 8.3L.685 10.431C.24 10.877 0 11.495 0 12.251c0 1.634 1.121 3.915 3.713 6.506C6.477 21.521 9.293 23 11.145 23c.648 0 1.18-.195 1.547-.562l8.086-8.078c.91.874-.778 3.538-.778 4.648a2 2 0 0 0 4-.001c0-3.184-1.425-6.81-2.857-9.34zM4.934 4.296c.527-.53 1.471-.791 2.656-.761L4.381 6.741c-.236-.978-.049-1.845.553-2.445zm9.292 4.079-.03-.029C12.904 7.054 10.393 3.99 11.1 3.283c.715-.715 3.488 1.521 5.062 3.096.862.862 2.088 2.247 2.937 3.458-1.717-1.074-3.491-1.469-4.873-1.462z\"/>' +\n        '</svg>'\n      ),\n      minor: true\n    });\n  }\n\n  _onClick(event) {\n    super._onClick(event);\n    // event adds a background color\n    if (this.container.classList.contains('active')) {\n      this.container.classList.remove('active');\n      this.setColor('transparent');\n    }\n    else {\n      this.container.classList.add('active');\n      this.setColor('rgba(0, 0, 0, 0.7)');\n    }\n  }\n\n  setColor(color) {\n    document.documentElement.style.backgroundColor = color;\n  }\n}\n","import { strToEl } from '../utils';\n\nfunction round(num, places) {\n  const mult = Math.pow(10, places);\n  return Math.floor(Math.round(num * mult)) / mult;\n}\n\nfunction humanSize(bytes) {\n  if (bytes < 1024) {\n    return bytes + ' bytes';\n  }\n  else {\n    return round(bytes / 1024, 2) + 'k';\n  }\n}\n\nexport default class Results {\n  constructor() {\n    this.container = strToEl(\n      '<div class=\"results\">' +\n        '<span class=\"size\"></span> ' +\n        '<span class=\"diff\"></span>' +\n      '</div>' +\n    '');\n\n    this._sizeEl = this.container.querySelector('.size');\n    this._diffEl = this.container.querySelector('.diff');\n  }\n\n  update({ size, comparisonSize }) {\n    if (comparisonSize) {\n      this._sizeEl.textContent = humanSize(comparisonSize) + ' → ' + humanSize(size);\n    } else {\n      this._sizeEl.textContent = humanSize(size);\n    }\n\n    this._diffEl.classList.remove('decrease', 'increase');\n\n    // just displaying a single size?\n    if (!comparisonSize) {\n      this._diffEl.textContent = '';\n      return;\n    }\n    else if (size === comparisonSize) {\n      this._diffEl.textContent = '100%';\n    }\n    else {\n      this._diffEl.textContent = round(size / comparisonSize * 100, 2) + '%';\n      this._diffEl.classList.add(size > comparisonSize ? 'increase' : 'decrease');\n    }\n  }\n}\n","export let createNanoEvents = () => ({\n  events: {},\n  emit(event, ...args) {\n    ;(this.events[event] || []).forEach(i => i(...args))\n  },\n  on(event, cb) {\n    ;(this.events[event] = this.events[event] || []).push(cb)\n    return () =>\n      (this.events[event] = (this.events[event] || []).filter(i => i !== cb))\n  }\n})\n","import { strToEl } from '../utils';\n\nexport default class MaterialSlider {\n  constructor(rangeEl) {\n    this.container = strToEl(\n      '<div class=\"material-slider\">' +\n        '<div class=\"track\">' +\n          '<div class=\"track-on\"></div>' +\n          '<div class=\"handle\">' +\n            '<div class=\"arrow\"></div>' +\n            '<div class=\"val\"></div>' +\n          '</div>' +\n        '</div>' +\n      '</div>'\n    );\n\n    this.range = rangeEl;\n    this._handle = this.container.querySelector('.handle');\n    this._trackOn = this.container.querySelector('.track-on');\n    this._val = this.container.querySelector('.val');\n\n    rangeEl.parentNode.insertBefore(this.container, rangeEl);\n    this.container.insertBefore(rangeEl, this.container.firstChild);\n\n    rangeEl.addEventListener('input', () => this._onInputChange());\n    this.range.addEventListener('mousedown', () => this._onRangeMouseDown());\n    this.range.addEventListener('touchstart', () => this._onRangeTouchStart());\n    this.range.addEventListener('touchend', () => this._onRangeTouchEnd());\n\n    this._setPosition();\n  }\n\n  _onRangeTouchStart() {\n    this.range.focus();\n  }\n\n  _onRangeTouchEnd() {\n    this.range.blur();\n  }\n\n  _onRangeMouseDown() {\n    this.range.classList.add('active');\n\n    const upListener = () => {\n      requestAnimationFrame(() => {\n        this.range.blur();\n      });\n      this.range.classList.remove('active');\n      document.removeEventListener('mouseup', upListener);\n    };\n    document.addEventListener('mouseup', upListener);\n  }\n\n  set value(newVal) {\n    this.range.value = newVal;\n    this._update();\n  }\n\n  _onInputChange() {\n    this._update();\n  }\n\n  _update() {\n    requestAnimationFrame(() => this._setPosition());\n  }\n\n  _setPosition() {\n    const { min, max, value } = this.range;\n    const percent = (Number(value) - min) / (max - min);\n\n    this._trackOn.style.width =\n      this._handle.style.left = percent * 100 + \"%\";\n\n    this._val.textContent = value;\n  }\n}\n","import { createNanoEvents } from 'nanoevents';\n\nimport { domReady } from '../utils';\nimport MaterialSlider from './material-slider';\nimport Ripple from './ripple';\n\nexport default class Settings {\n  constructor() {\n    this.emitter = createNanoEvents();\n    this._throttleTimeout = null;\n\n    domReady.then(() => {\n      this._pluginInputs = Array.from(\n        document.querySelectorAll('.settings .plugins input')\n      );\n      this._globalInputs = Array.from(\n        document.querySelectorAll('.settings .global input')\n      );\n\n      this._resetRipple = new Ripple();\n      this._resetBtn = document.querySelector('.setting-reset');\n      this._resetBtn.appendChild(this._resetRipple.container);\n\n      // map real range elements to Slider instances\n      this._sliderMap = new WeakMap();\n\n      // enhance ranges\n      Array.from(\n        document.querySelectorAll('.settings input[type=range]')\n      ).forEach(el => this._sliderMap.set(el, new MaterialSlider(el)));\n\n      this.container = document.querySelector('.settings');\n      this._scroller = document.querySelector('.settings-scroller');\n\n      this.container.addEventListener('input', e => this._onChange(e));\n      this._scroller.addEventListener('wheel', e => this._onMouseWheel(e));\n      this._resetBtn.addEventListener('click', e => this._onReset(e));\n\n      // Stop double-tap text selection.\n      // This stops all text selection which is kinda sad.\n      // I think this code will bite me.\n      this._scroller.addEventListener('mousedown', e => {\n        if (e.target.closest('input[type=range]')) return;\n        e.preventDefault();\n      });\n    });\n  }\n\n  _onMouseWheel(event) {\n    // Prevents bounce effect on desktop.\n    // Firefox uses DELTA_LINE on a mouse wheel, ignore it\n    if (!event.deltaMode) { // 0 is \"pixels\"\n      event.preventDefault();\n      event.currentTarget.scrollTop += event.deltaY;\n    }\n  }\n\n  _onChange(event) {\n    clearTimeout(this._throttleTimeout);\n\n    // throttle range\n    if (event.target.type == 'range') {\n      this._throttleTimeout = setTimeout(() => this.emitter.emit('change'), 150);\n    }\n    else {\n      this.emitter.emit('change');\n    }\n  }\n\n  _onReset() {\n    this._resetRipple.animate();\n    const oldSettings = this.getSettings();\n    // Set all inputs according to their initial attributes\n    for (const inputEl of this._globalInputs) {\n      if (inputEl.type == 'checkbox') {\n        inputEl.checked = inputEl.hasAttribute('checked');\n      }\n      else if (inputEl.type == 'range') {\n        this._sliderMap.get(inputEl).value = inputEl.getAttribute('value');\n      }\n    }\n\n    for (const inputEl of this._pluginInputs) {\n      inputEl.checked = inputEl.hasAttribute('checked');\n    }\n\n    this.emitter.emit('reset', oldSettings);\n    this.emitter.emit('change');\n  }\n\n  setSettings(settings) {\n    for (const inputEl of this._globalInputs) {\n      if (!(inputEl.name in settings)) continue;\n\n      if (inputEl.type == 'checkbox') {\n        inputEl.checked = settings[inputEl.name];\n      }\n      else if (inputEl.type == 'range') {\n        this._sliderMap.get(inputEl).value = settings[inputEl.name];\n      }\n    }\n\n    for (const inputEl of this._pluginInputs) {\n      if (!(inputEl.name in settings.plugins)) continue;\n      inputEl.checked = settings.plugins[inputEl.name];\n    }\n  }\n\n  getSettings() {\n    // fingerprint is used for cache lookups\n    const fingerprint = [];\n\n    const output = {\n      plugins: {}\n    };\n\n    this._globalInputs.forEach(inputEl => {\n      if (inputEl.name != 'gzip' && inputEl.name != 'original') {\n        if (inputEl.type == 'checkbox') {\n          fingerprint.push(Number(inputEl.checked));\n        }\n        else {\n          fingerprint.push('|' + inputEl.value + '|');\n        }\n      }\n\n      if (inputEl.type == 'checkbox') {\n        output[inputEl.name] = inputEl.checked;\n      }\n      else {\n        output[inputEl.name] = inputEl.value;\n      }\n    });\n\n    this._pluginInputs.forEach(inputEl => {\n      fingerprint.push(Number(inputEl.checked));\n      output.plugins[inputEl.name] = inputEl.checked;\n    });\n\n    output.fingerprint = fingerprint.join();\n\n    return output;\n  }\n}\n","import {\n  domReady,\n  transitionFromClass,\n  transitionToClass,\n  readFileAsText\n} from '../utils';\nimport Spinner from './spinner';\nimport { createNanoEvents } from 'nanoevents';\n\nexport default class MainMenu {\n  constructor() {\n    this.emitter = createNanoEvents();\n    this.allowHide = false;\n    this._spinner = new Spinner();\n\n    domReady.then(() => {\n      this.container = document.querySelector('.main-menu');\n      this._loadFileInput = document.querySelector('.load-file-input');\n      this._pasteInput = document.querySelector('.paste-input');\n      this._loadDemoBtn = document.querySelector('.load-demo');\n      this._loadFileBtn = document.querySelector('.load-file');\n      this._pasteLabel = document.querySelector('.menu-input');\n      this._overlay = this.container.querySelector('.overlay');\n      this._menu = this.container.querySelector('.menu');\n\n      document.querySelector('.menu-btn')\n        .addEventListener('click', e => this._onMenuButtonClick(e));\n\n      this._overlay.addEventListener('click', e => this._onOverlayClick(e));\n\n      this._loadFileBtn.addEventListener('click', e => this._onLoadFileClick(e));\n      this._loadDemoBtn.addEventListener('click', e => this._onLoadDemoClick(e));\n      this._loadFileInput.addEventListener('change', () => this._onFileInputChange());\n      this._pasteInput.addEventListener('input', () => this._onTextInputChange());\n    });\n  }\n\n  show() {\n    this.container.classList.remove('hidden');\n    transitionFromClass(this._overlay, 'hidden');\n    transitionFromClass(this._menu, 'hidden');\n  }\n\n  hide() {\n    if (!this.allowHide) return;\n    this.stopSpinner();\n    this.container.classList.add('hidden');\n    transitionToClass(this._overlay, 'hidden');\n    transitionToClass(this._menu, 'hidden');\n  }\n\n  stopSpinner() {\n    this._spinner.hide();\n  }\n\n  showFilePicker() {\n    this._loadFileInput.click();\n  }\n\n  setPasteInput(value) {\n    this._pasteInput.value = value;\n    this._pasteInput.dispatchEvent(new Event('input'));\n  }\n\n  _onOverlayClick(event) {\n    event.preventDefault();\n    this.hide();\n  }\n\n  _onMenuButtonClick(event) {\n    event.preventDefault();\n    this.show();\n  }\n\n  _onTextInputChange() {\n    const val = this._pasteInput.value.trim();\n\n    if (val.includes('</svg>')) {\n      this._pasteInput.value = '';\n      this._pasteInput.blur();\n\n      this._pasteLabel.appendChild(this._spinner.container);\n      this._spinner.show();\n\n      this.emitter.emit('svgDataLoad', {\n        data: val,\n        filename: 'image.svg'\n      });\n    }\n  }\n\n  _onLoadFileClick(event) {\n    event.preventDefault();\n    event.target.blur();\n    this.showFilePicker();\n  }\n\n  async _onFileInputChange() {\n    const file = this._loadFileInput.files[0];\n\n    if (!file) return;\n\n    this._loadFileBtn.appendChild(this._spinner.container);\n    this._spinner.show();\n\n    this.emitter.emit('svgDataLoad', {\n      data: await readFileAsText(file),\n      filename: file.name\n    });\n  }\n\n  async _onLoadDemoClick(event) {\n    event.preventDefault();\n    event.target.blur();\n    this._loadDemoBtn.appendChild(this._spinner.container);\n    this._spinner.show();\n\n    try {\n      this.emitter.emit('svgDataLoad', {\n        data: await fetch('test-svgs/car-lite.svg').then(r => r.text()),\n        filename: 'car-lite.svg'\n      });\n    }\n    catch (err) {\n      this.stopSpinner();\n\n      const error = 'serviceWorker' in navigator && navigator.serviceWorker.controller ?\n        Error(\"Demo not available offline\") :\n        Error(\"Couldn't fetch demo SVG\");\n\n      this.emitter.emit('error', { error });\n    }\n  }\n}\n","import { strToEl, transitionToClass } from '../utils';\n\nclass Toast {\n  constructor(message, duration, buttons) {\n    this.container = strToEl(\n      '<div class=\"toast\"><div class=\"toast-content\"></div></div>' +\n    '');\n\n    this._content = this.container.querySelector('.toast-content');\n    this._content.textContent = message;\n    this._answerResolve;\n    this._hideTimeout;\n\n    this.answer = new Promise(r => this._answerResolve = r);\n\n    buttons.forEach(button => {\n      var buttonEl = document.createElement('button');\n      buttonEl.className = 'unbutton';\n      buttonEl.textContent = button;\n      buttonEl.addEventListener('click', () => {\n        this._answerResolve(button);\n      });\n      this.container.appendChild(buttonEl);\n    });\n\n    if (duration) {\n      this._hideTimeout = setTimeout(() => this.hide(), duration);\n    }\n  }\n\n  hide() {\n    clearTimeout(this._hideTimeout);\n    this._answerResolve();\n    return transitionToClass(this.container, 'hide');\n  }\n}\n\nexport default class Toasts {\n  constructor() {\n    this.container = strToEl(\"<div class='toasts'></div>\");\n  }\n\n  show(message, {\n    duration = 0,\n    buttons = ['dismiss']\n  }={}) {\n    const toast = new Toast(message, duration, buttons);\n    this.container.appendChild(toast.container);\n\n    toast.answer.then(() => toast.hide()).then(() => {\n      this.container.removeChild(toast.container);\n    });\n\n    return toast;\n  }\n}\n","import { createNanoEvents } from 'nanoevents';\nimport {\n  strToEl,\n  domReady,\n  transitionToClass,\n  transitionFromClass,\n  readFileAsText\n} from '../utils';\n\nexport default class FileDrop {\n  constructor() {\n    this.emitter = createNanoEvents();\n    this.container = strToEl(\n      '<div class=\"drop-overlay\">Drop it!</div>' +\n    '');\n\n    // drag events are horrid\n    this._activeEnters = 0;\n    this._currentEnteredElement = null;\n\n    domReady.then(() => {\n      document.addEventListener('dragover', event => event.preventDefault());\n      document.addEventListener('dragenter', event => this._onDragEnter(event));\n      document.addEventListener('dragleave', () => this._onDragLeave());\n      document.addEventListener('drop', event => this._onDrop(event));\n    });\n  }\n\n  _onDragEnter(event) {\n    // firefox double-fires on window enter, this works around it\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1124645\n    if (this._currentEnteredElement == event.target) return;\n    this._currentEnteredElement = event.target;\n\n    if (!this._activeEnters++) {\n      transitionToClass(this.container);\n    }\n  }\n\n  _onDragLeave() {\n    this._currentEnteredElement = null;\n\n    if (!--this._activeEnters) {\n      transitionFromClass(this.container);\n    }\n  }\n\n  async _onDrop(event) {\n    event.preventDefault();\n\n    this._activeEnters = 0;\n    transitionFromClass(this.container);\n\n    const file = event.dataTransfer.files[0];\n    if (!file) return;\n\n    this.emitter.emit('svgDataLoad', {\n      data: await readFileAsText(file),\n      filename: file.name\n    });\n  }\n}\n","import { domReady, transitionFromClass } from '../utils';\n\nexport default class Preloader {\n  constructor() {\n    domReady.then(() => {\n      this.container = document.querySelector('.preloader');\n      this.activated = this.container.classList.contains('active');\n      this.hide();\n    });\n  }\n\n  async hide() {\n    await transitionFromClass(this.container, 'active');\n    this.container.style.display = 'none';\n  }\n}\n","import { strToEl, escapeHtmlTag, transitionToClass, domReady } from '../utils';\n\nexport default class Changelog {\n  constructor(loadedVersion) {\n    this.container = strToEl('<section class=\"changelog\"></section>');\n    this._loadedVersion = loadedVersion;\n  }\n\n  async showLogFrom(lastLoadedVersion) {\n    if (lastLoadedVersion == this._loadedVersion) return;\n    const changelog = await fetch('changelog.json').then(r => r.json());\n    let startIndex = 0;\n    let endIndex = 0;\n\n    for (var i = 0; i < changelog.length; i++) {\n      const entry = changelog[i];\n\n      if (entry.version === this._loadedVersion) {\n        startIndex = i;\n      }\n      else if (entry.version === lastLoadedVersion) {\n        break;\n      }\n      endIndex = i + 1;\n    }\n\n    const changeLis = changelog.slice(startIndex, endIndex)\n      .reduce((arr, entry) => arr.concat(entry.changes), [])\n      .map(change => escapeHtmlTag`<li>${change}</li>`);\n\n    this.container.appendChild(strToEl('<h1>Updated!</h1>'));\n    this.container.appendChild(strToEl(\n      '<ul>' +\n        changeLis.join('') +\n      '</ul>' +\n    ''));\n\n    await domReady;\n    transitionToClass(this.container);\n  }\n}\n","import { domReady } from '../utils';\n\nexport default class ResultsContainer {\n  constructor(results) {\n    this._results = results;\n\n    domReady.then(() => {\n      this._mobileContainer = document.querySelector('.results-container-mobile');\n      this._container = document.querySelector('.results-container');\n      this._query = matchMedia('(min-width: 640px)');\n\n      this._query.addListener(() => this._positionResults());\n      this._positionResults();\n    });\n  }\n\n  _positionResults() {\n    if (this._query.matches) {\n      this._container.appendChild(this._results.container);\n    }\n    else {\n      this._mobileContainer.appendChild(this._results.container);\n    }\n  }\n}\n","import { createNanoEvents } from 'nanoevents';\nimport { domReady } from '../utils';\n\n/**\n * Tabs that toggle between showing the SVG image and XML markup.\n */\nexport default class ViewToggler {\n  constructor() {\n    this.emitter = createNanoEvents();\n    /** @type {HTMLFormElement | null} */\n    this.container = null;\n\n    domReady.then(() => {\n      this.container = document.querySelector('.view-toggler');\n\n      // stop browsers remembering previous form state\n      this.container.output[0].checked = true;\n\n      this.container.addEventListener('change', () => this._onChange());\n    });\n  }\n\n  _onChange() {\n    this.emitter.emit('change', {\n      value: this.container.output.value\n    });\n  }\n}\n","export default class ResultsCache {\n  constructor(size) {\n    this._size = size;\n    this.purge();\n  }\n\n  purge() {\n    this._fingerprints = [];\n    this._items = [];\n    this._index = 0;\n  }\n\n  add(fingerprint, svgFile) {\n    const oldItem = this._items[this._index];\n\n    if (oldItem) {\n      // gc blob url\n      oldItem.release();\n    }\n\n    this._fingerprints[this._index] = fingerprint;\n    this._items[this._index] = svgFile;\n\n    this._index = (this._index + 1) % this._size;\n  }\n\n  match(fingerprint) {\n    return this._items[this._fingerprints.indexOf(fingerprint)];\n  }\n}\n","import { transitionToClass } from '../utils';\n\nexport default class MainUi {\n  constructor(...elements) {\n    this._activated = false;\n    this._toActivate = elements;\n  }\n\n  activate() {\n    if (this._activated) return;\n    this._activated = true;\n\n    return Promise.all(\n      this._toActivate.map(el => transitionToClass(el))\n    );\n  }\n}\n","import { idbKeyval as storage } from '../utils/storage';\nimport Svgo from './svgo';\nimport { domReady } from './utils';\nimport Output from './ui/output';\nimport DownloadButton from './ui/download-button';\nimport CopyButton from './ui/copy-button';\nimport BgFillButton from './ui/bg-fill-button';\nimport Results from './ui/results';\nimport Settings from './ui/settings';\nimport MainMenu from './ui/main-menu';\nimport Toasts from './ui/toasts';\nimport FileDrop from './ui/file-drop';\nimport Preloader from './ui/preloader';\nimport Changelog from './ui/changelog';\nimport ResultsContainer from './ui/results-container';\nimport ViewToggler from './ui/view-toggler';\nimport ResultsCache from './results-cache';\nimport MainUi from './ui/main-ui';\n\nconst svgo = new Svgo();\n\nexport default class MainController {\n  constructor() {\n    this._container = null;\n\n    // ui components\n    this._mainUi = null;\n    this._outputUi = new Output();\n    this._downloadButtonUi = new DownloadButton();\n    this._copyButtonUi = new CopyButton();\n    this._bgFillUi = new BgFillButton();\n    this._resultsUi = new Results();\n    this._settingsUi = new Settings();\n    this._mainMenuUi = new MainMenu();\n    this._toastsUi = new Toasts();\n    this._dropUi = new FileDrop();\n    this._preloaderUi = new Preloader();\n    this._changelogUi = new Changelog(self.version);\n    this._resultsContainerUi = new ResultsContainer(this._resultsUi);\n    this._viewTogglerUi = new ViewToggler();\n\n    // ui events\n    this._settingsUi.emitter.on('change', () => this._onSettingsChange());\n    this._settingsUi.emitter.on('reset', oldSettings => this._onSettingsReset(oldSettings));\n    this._mainMenuUi.emitter.on('svgDataLoad', e => this._onInputChange(e));\n    this._dropUi.emitter.on('svgDataLoad', e => this._onInputChange(e));\n    this._mainMenuUi.emitter.on('error', ({error}) => this._handleError(error));\n    this._viewTogglerUi.emitter.on('change', e => this._onViewSelectionChange(e));\n    window.addEventListener('keydown', e => this._onGlobalKeyDown(e));\n    window.addEventListener('paste', e => this._onGlobalPaste(e));\n    window.addEventListener('copy', e => this._onGlobalCopy(e));\n\n    // state\n    this._inputItem = null;\n    this._cache = new ResultsCache(10);\n    this._latestCompressJobId = 0;\n    this._userHasInteracted = false;\n    this._reloading = false;\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.register('sw.js', {\n        scope: './'\n      }).then(registration => {\n        registration.addEventListener('updatefound', () => this._onUpdateFound(registration));\n      });\n    }\n\n    // tell the user about the latest update\n    storage.get('last-seen-version').then(lastSeenVersion => {\n      if (lastSeenVersion) {\n        this._changelogUi.showLogFrom(lastSeenVersion);\n      }\n      storage.set('last-seen-version', self.version);\n    });\n\n    domReady.then(() => {\n      this._container = document.querySelector('.app-output');\n\n      // elements for intro anim\n      this._mainUi = new MainUi(\n        document.querySelector('.toolbar'),\n        document.querySelector('.action-button-container'),\n        this._outputUi.container,\n        this._settingsUi.container\n      );\n\n      const actionContainer = document.querySelector('.action-button-container');\n      const minorActionContainer = document.querySelector('.minor-action-container');\n\n      minorActionContainer.appendChild(this._bgFillUi.container);\n\n      minorActionContainer.appendChild(this._copyButtonUi.container);\n      \n      actionContainer.appendChild(this._downloadButtonUi.container);\n\n      document.querySelector('.output').appendChild(this._outputUi.container);\n      this._container.appendChild(this._toastsUi.container);\n      this._container.appendChild(this._dropUi.container);\n      document.querySelector('.menu-extra').appendChild(this._changelogUi.container);\n\n      // load previous settings\n      this._loadSettings();\n\n      // someone managed to hit the preloader, aww\n      if (this._preloaderUi.activated) {\n        this._toastsUi.show(\"Ready now!\", {\n          duration: 3000\n        });\n      }\n\n      // for testing\n      // eslint-disable-next-line no-constant-condition\n      if (false) {\n        (async () => {\n          this._onInputChange({\n            data: await fetch('test-svgs/car-lite.svg').then(r => r.text()),\n            filename: 'car-lite.svg'\n          });\n        })();\n      }\n    });\n  }\n\n  _onGlobalKeyDown(event) {\n    if (event.key === 'o' && (event.ctrlKey || event.metaKey)) {\n      event.preventDefault();\n      this._mainMenuUi.showFilePicker();\n    }\n\n    if (event.key === 'Escape') {\n      this._mainMenuUi.hide();\n    }\n  }\n\n  _onGlobalPaste(event) {\n    const val = event.clipboardData.getData('text').trim();    \n    if (!val.includes(\"</svg>\")) {\n      this._toastsUi.show(\"Pasted value not an SVG\", {\n        duration: 2000\n      });\n    }\n    else {\n      this._mainMenuUi.setPasteInput(val);\n      event.preventDefault();\n    }\n  }\n\n  _onGlobalCopy(event) {\n    const selection = window.getSelection();\n    if (!selection.isCollapsed) return;\n\n    if (this._copyButtonUi.copyText()) {\n      this._toastsUi.show(\"Copy successful\", {\n        duration: 2000\n      });\n    }\n    else {\n      this._toastsUi.show(\"Nothing to copy\", {\n        duration: 2000\n      });\n    }\n    event.preventDefault();\n  }\n\n  _onViewSelectionChange(event) {\n    this._outputUi.set(event.value);\n  }\n\n  _onUpdateFound(registration) {\n    const newWorker = registration.installing;\n\n    registration.installing.addEventListener('statechange', async () => {\n      if (this._reloading) return;\n\n      // the very first activation!\n      // tell the user stuff works offline\n      if (newWorker.state == 'activated' && !navigator.serviceWorker.controller) {\n        this._toastsUi.show(\"Ready to work offline\", {\n          duration: 5000\n        });\n        return;\n      }\n\n      if (newWorker.state == 'activated' && navigator.serviceWorker.controller) {\n        // if the user hasn't interacted yet, do a sneaky reload\n        if (!this._userHasInteracted) {\n          this._reloading = true;\n          location.reload();\n          return;\n        }\n\n        // otherwise, show the user an alert\n        const toast = this._toastsUi.show(\"Update available\", {\n          buttons: ['reload', 'dismiss']\n        });\n\n        const answer = await toast.answer;\n\n        if (answer == 'reload') {\n          this._reloading = true;\n          location.reload();\n        }\n      }\n    });\n  }\n\n  _onSettingsChange() {\n    const settings = this._settingsUi.getSettings();\n    this._saveSettings(settings);\n    this._compressSvg(settings);\n  }\n\n  async _onSettingsReset(oldSettings) {\n    const toast = this._toastsUi.show(\"Settings reset\", {\n      buttons: ['undo', 'dismiss'],\n      duration: 5000\n    });\n\n    if ((await toast.answer) === 'undo') {\n      this._settingsUi.setSettings(oldSettings);\n      this._onSettingsChange();\n    }\n  }\n\n  async _onInputChange(event) {\n    const settings = this._settingsUi.getSettings();\n    this._userHasInteracted = true;\n\n    try {\n      this._inputItem = await svgo.wrapOriginal(event.data);\n      this._inputFilename = event.filename;\n    }\n    catch(e) {\n      const error = new Error(\"Load failed: \" + e.message);\n      this._mainMenuUi.stopSpinner();\n      this._handleError(error);\n      return;\n    }\n\n    this._cache.purge();\n\n    this._compressSvg(settings);\n    this._outputUi.reset();\n    this._mainUi.activate();\n    this._mainMenuUi.allowHide = true;\n    this._mainMenuUi.hide();\n  }\n\n  _handleError(e) {\n    this._toastsUi.show(e.message);\n    console.error(e);\n  }\n\n  async _loadSettings() {\n    const settings = await storage.get('settings');\n    if (settings) this._settingsUi.setSettings(settings);\n  }\n\n  _saveSettings(settings) {\n    const copy = Object.assign({}, settings);\n    // doesn't make sense to retain the \"show original\" option\n    delete copy.original;\n    storage.set('settings', copy);\n  }\n\n  async _compressSvg(settings) {\n    const thisJobId = this._latestCompressJobId = Math.random();\n\n    await svgo.abort();\n\n    if (thisJobId != this._latestCompressJobId) {\n      // while we've been waiting, there's been a newer call\n      // to _compressSvg, we don't need to do anything\n      return;\n    }\n\n    if (settings.original) {\n      this._updateForFile(this._inputItem, {\n        compress: settings.gzip\n      });\n      return;\n    }\n\n    const cacheMatch = this._cache.match(settings.fingerprint);\n\n    if (cacheMatch) {\n      this._updateForFile(cacheMatch, {\n        compareToFile: this._inputItem,\n        compress: settings.gzip\n      });\n      return;\n    }\n\n    this._downloadButtonUi.working();\n\n    try {\n      const finalResultFile = await svgo.process(this._inputItem.text, settings);\n\n      this._updateForFile(finalResultFile, {\n        compareToFile: this._inputItem,\n        compress: settings.gzip\n      });\n\n      this._cache.add(settings.fingerprint, finalResultFile);\n    }\n    catch (e) {\n      if (e.name === \"AbortError\") return;\n      e.message = \"Minifying error: \" + e.message;\n      this._handleError(e);\n    }\n    finally {\n      this._downloadButtonUi.done();\n    }\n  }\n\n  async _updateForFile(svgFile, { compareToFile, compress }) {\n    this._outputUi.update(svgFile);\n    this._downloadButtonUi.setDownload(this._inputFilename, svgFile);\n    this._copyButtonUi.setCopyText(svgFile.text);\n\n    this._resultsUi.update({\n      comparisonSize: compareToFile && (await compareToFile.size({ compress })),\n      size: await svgFile.size({ compress })\n    });\n  }\n}\n\n","import WorkerMessenger from './worker-messenger';\nimport SvgFile from './svg-file';\n\nexport default class Svgo extends WorkerMessenger {\n  constructor() {\n    super('js/svgo-worker.js');\n    this._currentJob = Promise.resolve();\n  }\n\n  async wrapOriginal(svgText) {\n    const {width, height} = await this._requestResponse({\n      action: 'wrapOriginal',\n      data: svgText\n    });\n\n    return new SvgFile(svgText, width, height);\n  }\n\n  process(svgText, settings) {\n    this.abort();\n\n    return this._currentJob = this._currentJob.catch(() => {}).then(async () => {\n      const result = await this._requestResponse({\n        action: 'process',\n        settings,\n        data: svgText,\n      });\n\n      // return final result\n      return new SvgFile(result.data, result.dimensions.width, result.dimensions.height);\n    });\n  }\n}\n","import { trackFocusMethod } from './utils';\nimport MainController from './main-controller';\n\ntrackFocusMethod();\nnew MainController();\n"],"names":["domReady","Promise","resolve","checkState","document","readyState","addEventListener","range","createRange","strToEl","str","createContextualFragment","children","selectNode","documentElement","entityMap","escapeHtmlTag","strings","values","map","s","String","replace","reduce","val","i","readFileAsText","file","Response","text","transitionClassFunc","removeClass","el","className","transitionClass","classList","contains","transitionEnd","listener","event","target","removeEventListener","remove","add","requestAnimationFrame","transitionTimeout","setTimeout","race","transitionToClass","transitionFromClass","idbKeyval","db","getDB","reject","openreq","indexedDB","open","onerror","error","onupgradeneeded","result","createObjectStore","onsuccess","async","withStore","type","callback","transaction","oncomplete","objectStore","key","req","store","get","set","value","put","delete","self","localStorage","getItem","setItem","removeItem","WorkerMessenger","constructor","url","this","_requestId","_pending","_url","_worker","release","_abortPending","terminate","abort","Object","keys","length","_startWorker","_fulfillPending","DOMException","Worker","onmessage","_onMessage","_postMessage","message","postMessage","data","id","Error","console","log","resolver","_requestResponse","gzip","super","compress","svgData","SvgFile","width","height","_compressedSize","then","r","byteLength","URL","createObjectURL","Blob","revokeObjectURL","getXY","obj","x","pageX","y","pageY","touchDistance","touch1","touch2","dx","Math","abs","dy","sqrt","getMidpoint","point1","point2","getPoints","touches","Array","from","t","PanZoom","eventArea","shouldCaptureFunc","_target","_shouldCaptureFunc","_dx","_dy","_scale","_active","_lastPoints","forEach","funcName","bind","_onPointerDown","e","_onWheel","reset","_update","preventDefault","boundingRect","getBoundingClientRect","delta","deltaY","deltaMode","max","min","scaleDiff","left","top","_onFirstPointerDown","_onPointerMove","_onPointerUp","button","points","averagePoint","averageLastPoint","style","transform","pop","SvgOutput","container","_svgFrame","querySelector","scrolling","_svgContainer","_panZoom","setSvg","svgFile","nextLoad","_nextLoadPromise","src","encodeURIComponent","onload","prism","highlight","CodeOutput","_codeEl","innerHTML","Output","_types","image","code","_svgFile","_switchQueue","noAnimate","update","_activeType","toRemove","toAdd","appendChild","transitions","push","all","removeChild","Ripple","animate","offsetLeft","Spinner","_showTimeout","display","show","delay","clearTimeout","hide","FloatingActionButton","title","href","iconSvg","minor","setAttribute","_ripple","_spinner","_onClick","working","done","DownloadButton","setDownload","filename","download","CopyButton","_text","_pre","createElement","copyText","textContent","body","getSelection","removeAllRanges","window","addRange","execCommand","setCopyText","BgFillButton","setColor","color","backgroundColor","round","num","places","mult","pow","floor","humanSize","bytes","Results","_sizeEl","_diffEl","size","comparisonSize","createNanoEvents","events","emit","args","on","cb","filter","MaterialSlider","rangeEl","_handle","_trackOn","_val","parentNode","insertBefore","firstChild","_onInputChange","_onRangeMouseDown","_onRangeTouchStart","_onRangeTouchEnd","_setPosition","focus","blur","upListener","newVal","percent","Number","Settings","emitter","_throttleTimeout","_pluginInputs","querySelectorAll","_globalInputs","_resetRipple","_resetBtn","_sliderMap","WeakMap","_scroller","_onChange","_onMouseWheel","_onReset","closest","currentTarget","scrollTop","oldSettings","getSettings","inputEl","checked","hasAttribute","getAttribute","setSettings","settings","name","plugins","fingerprint","output","join","MainMenu","allowHide","_loadFileInput","_pasteInput","_loadDemoBtn","_loadFileBtn","_pasteLabel","_overlay","_menu","_onMenuButtonClick","_onOverlayClick","_onLoadFileClick","_onLoadDemoClick","_onFileInputChange","_onTextInputChange","stopSpinner","showFilePicker","click","setPasteInput","dispatchEvent","Event","trim","includes","files","fetch","err","navigator","serviceWorker","controller","Toast","duration","buttons","_content","_answerResolve","_hideTimeout","answer","buttonEl","Toasts","toast","FileDrop","_activeEnters","_currentEnteredElement","_onDragEnter","_onDragLeave","_onDrop","dataTransfer","Preloader","activated","Changelog","loadedVersion","_loadedVersion","lastLoadedVersion","changelog","json","startIndex","endIndex","entry","version","changeLis","slice","arr","concat","changes","change","ResultsContainer","results","_results","_mobileContainer","_container","_query","matchMedia","addListener","_positionResults","matches","ViewToggler","ResultsCache","_size","purge","_fingerprints","_items","_index","oldItem","match","indexOf","MainUi","elements","_activated","_toActivate","activate","svgo","_currentJob","svgText","action","process","catch","dimensions","focusMethod","_mainUi","_outputUi","_downloadButtonUi","_copyButtonUi","_bgFillUi","_resultsUi","_settingsUi","_mainMenuUi","_toastsUi","_dropUi","_preloaderUi","_changelogUi","_resultsContainerUi","_viewTogglerUi","_onSettingsChange","_onSettingsReset","_handleError","_onViewSelectionChange","_onGlobalKeyDown","_onGlobalPaste","_onGlobalCopy","_inputItem","_cache","_latestCompressJobId","_userHasInteracted","_reloading","register","scope","registration","_onUpdateFound","storage","lastSeenVersion","showLogFrom","actionContainer","minorActionContainer","_loadSettings","ctrlKey","metaKey","clipboardData","getData","isCollapsed","newWorker","installing","state","location","reload","_saveSettings","_compressSvg","wrapOriginal","_inputFilename","copy","assign","original","thisJobId","random","_updateForFile","cacheMatch","compareToFile","finalResultFile"],"mappings":"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"}